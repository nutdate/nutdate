#!/bin/bash/zsh

# р╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣Мр╕кр╕│р╕лр╕гр╕▒р╕Ър╕кр╣Ир╕Зр╣Вр╕Др╣Йр╕Фр╕Вр╕╢р╣Йр╕Щ Git
# р╕зр╕┤р╕Шр╕╡р╣Гр╕Кр╣Й: ./deploy.sh "р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б commit р╕Вр╕нр╕Зр╕Др╕╕р╕У"

# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕бр╕╡ commit message р╕кр╣Ир╕Зр╕бр╕▓р╕Фр╣Йр╕зр╕вр╕лр╕гр╕╖р╕нр╣Др╕бр╣И
if [ -z "$1" ]; then
  echo "ЁЯЫС Error: р╕Бр╕гр╕╕р╕Ур╕▓р╣Гр╕кр╣Ир╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕кр╕│р╕лр╕гр╕▒р╕Ъ commit"
  echo "р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З: ./deploy.sh \"р╣Бр╕Бр╣Йр╣Др╕Вр╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣М A\""
  exit 1
fi

echo "ЁЯЪА р╣Ар╕гр╕┤р╣Ир╕бр╕Бр╕гр╕░р╕Ър╕зр╕Щр╕Бр╕▓р╕г Deploy..."

# 1. Add р╣Др╕Яр╕ер╣Мр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
git add .

# 2. Commit р╕Юр╕гр╣Йр╕нр╕бр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Чр╕╡р╣Ир╕гр╕▒р╕Ър╕бр╕▓
git commit -m "$1"

# 3. Push р╣Вр╕Др╣Йр╕Фр╣Др╕Ыр╕вр╕▒р╕З branch 'main' (р╕лр╕гр╕╖р╕н 'master' р╣Бр╕ер╣Йр╕зр╣Бр╕Хр╣Ир╣Вр╕Ыр╕гр╣Ар╕Ир╕Бр╕Хр╣М)
git push origin main

echo "тЬЕ Push р╣Вр╕Др╣Йр╕Фр╕Вр╕╢р╣Йр╕Щ Git р╕кр╕│р╣Ар╕гр╣Зр╕И! р╕гр╕нр╣Гр╕лр╣Й EC2 р╕Чр╕│р╕Зр╕▓р╕Щр╕Хр╣Ир╕н..."
